# Embedded file name: /entities/client/Bitcasters/mode/Inventory.py
import BigWorld, GUI, ResMgr
from cursor import cursor
from Util import ignore
from keys import *
from Mode import Mode
from Cameras import AimInventoryCameraAt, AimCursorCameraAt
from InventoryItem import keyToSlotID, slotIDToKey

class Inventory(Mode):

    def __init__(self, handler):
        cursor('mouse')
        cursor.locked = True
        Mode.__init__(self, handler, {KEY_ESCAPE: [ignore, self.click_exit],
         KEY_I: [ignore, self.click_exit]})
        from Bitcasters.layers.Factory import create
        self.layer = create('inventory', 0.75, owner=self, full=True)
        self.updateInventory()
        AimInventoryCameraAt(BigWorld.player())
        cursor.locked = False

    def cleanup(self):
        self.layer.cleanup()

    def click_icon(self, component):
        slotID = keyToSlotID((0, int(component)))
        if slotID in BigWorld.player().inventory:
            BigWorld.player().base.manageInventory(slotID)

    def click_exit(self):
        """Return to the game world."""
        from BWPersonality import changeMode
        AimCursorCameraAt(BigWorld.player())
        changeMode('WorldMode')

    def updateInventory(self, *ignored):
        p = BigWorld.player()
        self.layer.update(p.gold, p.inventory)